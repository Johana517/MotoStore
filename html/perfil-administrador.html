<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Moto Store</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <link
      rel="stylesheet"
      href="../fontawesome-free-6.7.2-web/css/all.min.css"
    />
    <link rel="icon" type="image/png" href="../img/logo_moto_store-1-5.png" />
    <link rel="stylesheet" href="/css/style.css" />

    <style>
      /* Header Styles */
      .header-container {
        width: 100%;
        padding: 10px 0;
      }
      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 0 auto;
        padding: 0 20px;
      }
      .navbar-brand img {
        height: 150px;
        width: auto;
      }

      /* Profile Image Styles */
      .profile-menu {
        margin-left: auto;
      }

      .profile-dropdown .nav-link {
        background-color: white;
        color: black;
        border: 1px solid #ddd;
        padding: 8px 15px;
        border-radius: 5px;
        display: flex;
        align-items: center;
      }

      .profile-dropdown .nav-link i {
        margin-right: 8px;
        font-size: 1.2rem;
      }

      .profile-dropdown .dropdown-menu {
        background-color: white;
        border: 1px solid #ddd;
      }

      .profile-dropdown .dropdown-item {
        color: black;
      }

      .profile-dropdown .dropdown-item:hover {
        background-color: #cc0000;
        color: white;
      }

      /* Section Title */
      .section-title {
        color: #343a40;
        font-weight: 600;
        border-bottom: 2px solid #343a40;
        padding-bottom: 8px;
        margin-bottom: 20px;
      }

      /* Dropdown Customization */
      .profile-dropdown .dropdown-menu {
        min-width: 150px;
        top: 100%;
        left: auto;
        right: 0;
        margin-top: 0;
        position: absolute;
      }

      /* Modal Enhancements */
      .modal-perfil .modal-header {
        background-color: #343a40;
        color: #fff;
      }
      .modal-perfil .modal-footer {
        background-color: #f8f9fa;
      }
      .card {
        border: none;
        border-radius: 8px;
      }
      .form-group label {
        font-weight: 500;
      }

      /* Responsive Adjustments */
      @media (max-width: 768px) {
        .header-content {
          flex-direction: column;
          text-align: center;
        }
        .navbar-brand img {
          margin-bottom: 10px;
        }
        .row {
          flex-direction: column;
        }
        .col-md-4,
        .col-md-8 {
          width: 100%;
          max-width: 100%;
        }
        .profile-dropdown .dropdown-menu {
          right: 50%;
          transform: translateX(50%);
        }
      }
    </style>
  </head>
  <body>
    <header class="header-container">
      <div class="header-content">
        <a class="navbar-brand" href="sesion-administrador.html">
          <img
            src="../img/logo_moto_store-1-5.png"
            style="height: 150px; width: 150px"
            alt="logo"
          />
        </a>
    </header>

    <div class="container mt-4">
      <div class="row">
        <div class="col-md-4 text-center">
          <div class="profile-img-container">
            <img
              src="../img/perfil.png"
              class="rounded-circle"
              alt="User Image"
              width="200"
              height="200"
            />
            <div
              class="profile-img-overlay"
              data-bs-toggle="modal"
              data-bs-target="#editarPerfilModal"
            >
              <div class="profile-img-overlay-text">
                <i class="fas fa-camera"></i>
                <p>Cambiar foto</p>
              </div>
            </div>
          </div>
          <h3>JUAN MANUEL TAPIAS SOLARTE</h3>
          <p>juanmtapias2021@gmail.com</p>
          <p>administrador</p>
        </div>
        <div class="col-md-8">
          <h4 class="section-title">Datos Personales</h4>
          <ul class="list-group">
            <li class="list-group-item">
              <strong>Nombre y Apellido:</strong> juan manuel tapias solarte
            </li>
            <li class="list-group-item">
              <strong>Teléfono:</strong> 3134123616
            </li>
            <li class="list-group-item">
              <strong>Correo Electrónico:</strong> juanmtapias2021@gmail.com
            </li>
            <li class="list-group-item">
              <strong>Dirección:</strong> B/ EL CARMEN
            </li>
          </ul>
          <button class="btn btn-dark mt-3" id="btnEditarPerfil">Editar</button>
        </div>
      </div>
    </div>

    <!-- Modal para editar perfil -->
    <div
      class="modal fade modal-perfil"
      id="editarPerfilModal"
      tabindex="-1"
      aria-labelledby="editarPerfilModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header bg-dark text-white">
            <h5 class="modal-title" id="editarPerfilModalLabel">
              Editar Perfil
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="formularioPerfil" class="needs-validation" novalidate>
              <!-- Sección Foto de Perfil -->
              <div class="text-center mb-4">
                <div
                  class="profile-img-container mx-auto"
                  onclick="document.getElementById('fotoPerfil').click()"
                >
                  <img
                    src="../img/perfil.png"
                    class="rounded-circle"
                    id="profileImage"
                    alt="Foto de perfil"
                    width="200"
                    height="200"
                  />
                  <div class="profile-img-overlay">
                    <div class="profile-img-overlay-text">
                      <i class="fas fa-camera"></i>
                      <p>Cambiar foto</p>
                    </div>
                  </div>
                </div>
                <input
                  type="file"
                  id="fotoPerfil"
                  class="d-none"
                  accept="image/*"
                />
                <small class="text-muted d-block mt-2"
                  >Haz clic en la imagen para cambiar tu foto</small
                >
              </div>

              <div class="container-fluid">
                <div class="row">
                  <div class="col-md-6">
                    <div class="card mb-4 shadow-sm">
                      <div class="card-body">
                        <h5 class="section-title">
                          <i class="fas fa-user-circle"></i> Información
                          Personal
                        </h5>
                        <div class="form-group">
                          <label for="nombre">Nombre Completo</label>
                          <input
                            type="text"
                            class="form-control"
                            id="nombre"
                            value="JUAN MANUEL TAPIAS SOLARTE"
                            required
                          />
                          <div class="invalid-feedback">
                            Por favor ingresa tu nombre completo
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-6">
                    <div class="card mb-4 shadow-sm">
                      <div class="card-body">
                        <h5 class="section-title">
                          <i class="fas fa-address-book"></i> Contacto
                        </h5>
                        <div class="form-group">
                          <label for="email">Correo Electrónico</label>
                          <input
                            type="email"
                            class="form-control"
                            id="email"
                            value="juanmtapias2021@gmail.com"
                            required
                          />
                          <div class="invalid-feedback">
                            Ingresa un correo válido
                          </div>
                        </div>
                        <div class="form-group">
                          <label for="telefono">Teléfono</label>
                          <input
                            type="tel"
                            class="form-control"
                            id="telefono"
                            value="3134123616"
                            pattern="[0-9]{10}"
                            required
                          />
                          <div class="invalid-feedback">Teléfono requerido</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="card mb-3 shadow-sm">
                  <div class="card-body">
                    <h5 class="section-title">
                      <i class="fas fa-map-marker-alt"></i> Dirección
                    </h5>
                    <div class="form-group">
                      <label for="direccion">Dirección Residencial</label>
                      <input
                        type="text"
                        class="form-control"
                        id="direccion"
                        value="B/ EL CARMEN"
                        required
                      />
                      <div class="invalid-feedback">
                        Por favor ingresa tu dirección
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer bg-light">
            <button
              type="button"
              class="btn btn-outline-secondary"
              data-bs-dismiss="modal"
            >
              <i class="fas fa-times"></i> Cancelar
            </button>
            <button type="button" class="btn btn-dark" id="guardarCambios">
              <i class="fas fa-save"></i> Guardar Cambios
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../fontawesome-free-6.7.2-web/js/all.min.js"></script>
    <script src="../js/sweetalert2@11.js"></script>
    <script src="../js/logout.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize dropdowns
        const dropdowns = document.querySelectorAll(".dropdown-toggle");
        dropdowns.forEach((dropdown) => {
          dropdown.addEventListener("click", (e) => {
            e.preventDefault();
            const menu = dropdown.nextElementSibling;
            menu.classList.toggle("show");
          });
        });

        // Show modal on Edit click
        document
          .getElementById("btnEditarPerfil")
          .addEventListener("click", () => {
            const nombre = document
              .querySelector(".list-group-item:nth-child(1)")
              .textContent.split(":")[1]
              .trim();
            const telefono = document
              .querySelector(".list-group-item:nth-child(2)")
              .textContent.split(":")[1]
              .trim();
            const email = document
              .querySelector(".list-group-item:nth-child(3)")
              .textContent.split(":")[1]
              .trim();
            const direccion = document
              .querySelector(".list-group-item:nth-child(4)")
              .textContent.split(":")[1]
              .trim();

            document.getElementById("nombre").value = nombre;
            document.getElementById("telefono").value = telefono;
            document.getElementById("email").value = email;
            document.getElementById("direccion").value = direccion;

            new bootstrap.Modal(
              document.getElementById("editarPerfilModal")
            ).show();
          });

        // Form validation
        const form = document.getElementById("formularioPerfil");
        form.addEventListener("submit", (e) => {
          if (!form.checkValidity()) {
            e.preventDefault();
            e.stopPropagation();
          }
          form.classList.add("was-validated");
        });

        // Load selected image
        document
          .getElementById("fotoPerfil")
          .addEventListener("change", (e) => {
            if (e.target.files && e.target.files[0]) {
              const reader = new FileReader();
              reader.onload = (event) => {
                document.getElementById("profileImage").src =
                  event.target.result;
              };
              reader.readAsDataURL(e.target.files[0]);
            }
          });

        // Save changes
        document
          .getElementById("guardarCambios")
          .addEventListener("click", () => {
            if (form.checkValidity()) {
              const profileImg = document.querySelector(".rounded-circle");
              const nameDisplay = document.querySelector("h3");
              const emailDisplay = document.querySelector("p:first-child");

              profileImg.src = document.getElementById("profileImage").src;
              nameDisplay.textContent = `${
                document.getElementById("nombre").value.split(" ")[0]
              } ${document.getElementById("nombre").value.split(" ")[1]}`;
              emailDisplay.textContent = document.getElementById("email").value;

              document.querySelector(
                ".list-group-item:nth-child(1)"
              ).textContent = `Nombre y Apellido: ${
                document.getElementById("nombre").value
              }`;
              document.querySelector(
                ".list-group-item:nth-child(2)"
              ).textContent = `Teléfono: ${
                document.getElementById("telefono").value
              }`;
              document.querySelector(
                ".list-group-item:nth-child(3)"
              ).textContent = `Correo Electrónico: ${
                document.getElementById("email").value
              }`;
              document.querySelector(
                ".list-group-item:nth-child(4)"
              ).textContent = `Dirección: ${
                document.getElementById("direccion").value
              }`;

              Swal.fire({
                title: "¡Perfil actualizado!",
                text: "Tus cambios se han guardado correctamente",
                icon: "success",
                confirmButtonText: "Aceptar",
                confirmButtonColor: "#343a40",
                timer: 2000,
                timerProgressBar: true,
              }).then(() => {
                bootstrap.Modal.getInstance(
                  document.getElementById("editarPerfilModal")
                ).hide();
              });
            } else {
              Swal.fire({
                title: "Campos incompletos",
                text: "Por favor completa todos los campos requeridos",
                icon: "warning",
                confirmButtonText: "Entendido",
                confirmButtonColor: "#343a40",
              });
            }
            form.classList.add("was-validated");
          });

        // Hide dropdown on outside click
        document.addEventListener("click", (e) => {
          dropdowns.forEach((dropdown) => {
            const menu = dropdown.nextElementSibling;
            if (!dropdown.contains(e.target) && !menu.contains(e.target)) {
              menu.classList.remove("show");
            }
          });
        });
      });
    </script>
  </body>
</html>
